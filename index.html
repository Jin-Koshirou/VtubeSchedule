<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>onlyVans</title>
  <style>
    body { font-family: Arial, sans-serif; background: #1c1c1c; color: #f2f2f2; padding: 0; margin: 0; }
    header a:hover {
        background-color: #444;
    }
    h1 { text-align: center; }
    .section { margin: 30px 0; padding: 0 20px; }
    .section h2 {
        text-align: center;
        background-color: #444;
        color: #f2f2f2;
        padding: 10px;
        border-radius: 4px;
        margin: 20px 0 15px 0;
    }
    .cards {
        display: grid;
        grid-template-columns: repeat(5, 1fr); /* 5 colunas de tamanho igual */
        gap: 15px;
    }

    /* Para garantir que os cards nÃ£o fiquem muito pequenos em telas menores */
    @media (max-width: 1200px) {
        .cards { grid-template-columns: repeat(4, 1fr); } /* 4 colunas */
    }

    @media (max-width: 900px) {
        .cards { grid-template-columns: repeat(3, 1fr); } /* 3 colunas */
    }

    @media (max-width: 600px) {
        .cards { grid-template-columns: repeat(2, 1fr); } /* 2 colunas */
    }

    @media (max-width: 400px) {
        .cards { grid-template-columns: 1fr; } /* 1 coluna */
    }
    .live { background: #2a2a2a; padding: 10px; border-radius: 8px; position: relative; }
    .live.ao-vivo { border: 2px solid red; }
    .thumb-container {
        position: relative;
        display: block;
        padding-top: 56.25%; /* ProporÃ§Ã£o 16:9 (9/16 = 0.5625) */
        overflow: hidden;
        border-radius: 6px;
        margin: 8px 0;
    }

    .thumb-container img {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover; /* Garante que a imagem cubra todo o espaÃ§o */
        border-radius: 6px;
    }
    .play-btn {
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0,0,0,0.7);
      color: white;
      border: none;
      font-size: 16px;
      padding: 8px 12px;
      border-radius: 4px;
      cursor: pointer;
      text-decoration: none;
    }
    .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin: 8px 0;
        font-size: 16px;
        color: #aaa;
    }
    .data { font-size: 16px; color: #bbb; }
    .title {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
        text-overflow: ellipsis;
        min-height: 2.4em;
        max-height: 2.4em;
    }
    .ver-mais {
      display: block;
      margin: 10px auto;
      background: #444;
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 4px;
      cursor: pointer;
    }
    .ver-mais:hover { background: #666; }
  </style>
</head>
<header style="background-color: #2a2a2a; padding: 10px 0; margin: 0; box-shadow: 0 2px 5px rgba(0,0,0,0.2); width: 100%;">
  <nav style="max-width: 1200px; margin: 0 auto; padding: 0 20px; display: flex; justify-content: center; gap: 100px;">
      <a href="#" style="color: #f2f2f2; text-decoration: none; font-weight: 500; padding: 5px 10px; border-radius: 4px; transition: background-color 0.3s;">
          Kit ViralSync
      </a>
      <a href="#" style="color: #f2f2f2; text-decoration: none; font-weight: 500; padding: 5px 10px; border-radius: 4px; transition: background-color 0.3s;">
          FormulÃ¡rio
      </a>
      <a href="#" style="color: #f2f2f2; text-decoration: none; font-weight: 500; padding: 5px 10px; border-radius: 4px; transition: background-color 0.3s;">
          Envie sua Logo
      </a>
  </nav>
</header>
<body>
  
  <h1>onlyVans</h1>

  <div class="section">
    <h2>ðŸ“… Ontem</h2>
    <div id="ontem" class="cards"></div>
    <button class="ver-mais" data-section="ontem" style="display:none;">Ver mais</button>
  </div>

  <div class="section">
    <h2>ðŸ“… Hoje</h2>
    <div id="hoje" class="cards"></div>
    <button class="ver-mais" data-section="hoje" style="display:none;">Ver mais</button>
  </div>

  <div class="section">
    <h2>ðŸ“… AmanhÃ£</h2>
    <div id="amanha" class="cards"></div>
    <button class="ver-mais" data-section="amanha" style="display:none;">Ver mais</button>
  </div>

  <div class="section">
    <h2>ðŸ“… Depois de AmanhÃ£</h2>
    <div id="depois" class="cards"></div>
    <button class="ver-mais" data-section="depois" style="display:none;">Ver mais</button>
  </div>

  <script>
    const livesPorDia = { ontem: [], hoje: [], amanha: [], depois: [] };
    const exibidos = { ontem: 0, hoje: 0, amanha: 0, depois: 0 };
    const LIMITE_POR_PAGINA = 5;

    function getDiaAlvo(data) {
      const hoje = new Date();
      const dataVideo = new Date(data);
      const diff = Math.floor((dataVideo - hoje) / (1000 * 60 * 60 * 24));
      if (diff <= -1) return "ontem";
      if (diff === 0) return "hoje";
      if (diff === 1) return "amanha";
      if (diff === 2) return "depois";
      return null;
    }

    function criarCard(item, tipo) {
      const videoId = item.id;
      const div = document.createElement("div");
      div.className = "live";
      if (tipo === "live") div.classList.add("ao-vivo");
      div.innerHTML = `
        <div class="card-header">
          <span class="data">${new Intl.DateTimeFormat("pt-BR", { hour: "2-digit", minute: "2-digit" }).format(new Date(item.start))}</span><br>
          <span class="channel-title">${item.channel_title}</span>
        </div>
        <div class="thumb-container">
          <img src="${item.thumb}" alt="${item.title}">
          <a class="play-btn" href="https://www.youtube.com/watch?v=${videoId}" target="_blank">â–¶ Assistir</a>
        </div>
        <strong class="title">${item.title}</strong>
      `;
      return div;
    }

    function renderSection(dia) {
      const container = document.getElementById(dia);
      container.innerHTML = "";
      const lives = livesPorDia[dia];
      const inicio = exibidos[dia];
      // const fim = Math.min(inicio + LIMITE_POR_PAGINA, lives.length);
      const fim = lives.length;

      for (let i = 0; i < fim; i++) {
        container.appendChild(criarCard(lives[i].item, lives[i].tipo));
      }

      exibidos[dia] = fim;

      // Mostrar/esconder botÃ£o "ver mais"
      const btn = document.querySelector(`button[data-section="${dia}"]`);
      btn.style.display = (fim < lives.length) ? "block" : "none";
    }

    async function carregarLives() {

      const resp = await fetch("data/lives.json?t=" + new Date().getTime());
      const dados = await resp.json();
      

      // Limpa dados
      Object.keys(livesPorDia).forEach(dia => { livesPorDia[dia] = []; exibidos[dia] = 0; });

      // Preenche e ordena dados
      Object.keys(livesPorDia).forEach(dia => {
        if (dados[dia]) {
          dados[dia].sort((a, b) => Date.parse(a.start) - Date.parse(b.start))
          .forEach(item => {
            livesPorDia[dia].push({ item, tipo: item["live"] });
          });
        }
      });

      // Renderiza todas as seÃ§Ãµes
      Object.keys(livesPorDia).forEach(dia => renderSection(dia));

      // Rola para o primeiro card ao vivo
      const primeiraLive = document.querySelector('.live.ao-vivo');
      if (primeiraLive) {
        // Adiciona um pequeno atraso para garantir que o DOM foi renderizado
        setTimeout(() => {
          primeiraLive.scrollIntoView({ 
            behavior: 'smooth',
            block: 'center'
          });
        }, 300);
      }
    }

    // // BotÃµes "Ver mais"
    // document.querySelectorAll(".ver-mais").forEach(btn => {
    //   btn.addEventListener("click", () => {
    //     renderSection(btn.dataset.section);
    //   });
    // });

    carregarLives();
    setInterval(carregarLives, 3600000);
  </script>
</body>
</html>
